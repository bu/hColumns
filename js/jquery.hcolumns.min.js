// hColumns by bu <bu@hax4.in>, BSD License

(function(b){var f={nodeSource:function(){return window.alert("dummy source, you need to create a node source")},noContentString:"There is no node here",searchPlaceholderString:"Search...",searchable:!1,customNodeTypeIndicator:{},customNodeTypeHandler:{}},k={folder:function(a,c,d){a.nodeSource(d.id,function(c,d){return c?b.error(c):a.columnView._addColumnList(d,a.columnView)})},link:function(b,c,d){return window.open(d.url)}},l={folder:"icon-chevron-right",link:"icon-globe"},e={init:function(a){var c=
b.extend(f,a),d=b.extend(k,c.customNodeTypeHandler),g=b.extend(l,c.customNodeTypeIndicator);return this.each(function(){var a=b(this),h=a.data("columnView");e.settings=c;c.columnView=e;c.handlers=d;c.indicators=g;c.container_node=this;h||(a.data("hColumn",c),a.addClass("column-view-container"),b("<div></div>").addClass("column-view-composition").appendTo(a),a.on("click",".column ul li:not('.search')",c.columnView._entryClick),c.nodeSource(null,function(a,d){return a?b.error(a):c.columnView._addColumnList(d)}))})},
_entryClick:function(){var a=b(this).parents(".column-view-container").data("hColumn"),c=b(this).parents(".column-view-container"),d=b(this).parents(".column"),g=b(this).parents(".column").index(),e=b(this).data("node-type"),h=b(this).data("node-data");b(c).find(".column-view-composition .column:gt("+g+")").remove();d.find(".active").removeClass("active");b(this).addClass("active");return a.handlers[e](a,this,h)},_addColumnList:function(a,c){var d=c?c:this,e=b("<ul></ul>");if(0===a.length){var f=
b("<p></p>").text(c.settings.noContentString);return d._addColumn(f,d)}d.settings.searchable&&d._addColumnSearch(e);a.map(function(a){var c=b("<li></li>").data("node-id",a.id).data("node-type",a.type).data("node-data",a),f=b("<i></i>").addClass(d.settings.indicators[a.type]);c.append(document.createTextNode(a.label));c.append(f);c.appendTo(e)});return d._addColumn(e,d)},_addColumnSearch:function(a){b('<li class="search"><input type="text" placeholder=" '+this.settings.searchPlaceholderString+'"></li>').on("keyup",
"input",function(a){var d=b(this).val();2<=d.length?b(this).closest("li").siblings().each(function(){""!==d&&-1===b(this).data("node-data").label.toLowerCase().indexOf(d.toLowerCase())?b(this).hide():b(this).show()}):b(this).closest("li").siblings().show()}).appendTo(a)},_addColumn:function(a,c){var d=b("<div></div>").addClass("column");d.append(a);b(c.settings.container_node).find(".column-view-composition").append(d);b(c.settings.container_node).scrollLeft(b(".column-view-composition").width())}};
b.fn.hColumns=function(a){if(e[a])return e[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)b.error("Method "+a+" does not exist on jQuery.hColumns");else return e.init.apply(this,arguments)}})(jQuery);
